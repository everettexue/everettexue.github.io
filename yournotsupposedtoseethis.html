<!DOCTYPE html>

<!-- code from Rachelle Wise on Codepen -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Everetteâ€™s Parallax + Video Scroll</title>

  <!-- GSAP + ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      background: #000;
      overflow-x: hidden;
    }

    #smooth-wrapper {
      height: 100%;
      overflow: hidden;
    }

    #smooth-content {
      will-change: transform;
    }

    .parallax, .parallax1 {
      height: 100vh;
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    .parallax {
      background-image: url('images/without.JPG');
    }

    .parallax1 {
      background-image: url('images/with.JPG');
    }

    .video-section {
      position: relative;
      height: 100vh;
      overflow: hidden;
      background: #000;
    }

    .video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
    }

    /* optional: just to see scrolling clearly */
    body::after {
      content: "";
      display: block;
      height: 4000px;
      background: linear-gradient(180deg, #000 0%, #111 100%);
    }

    /* FFmpeg encoding reminder
    --------------------------------
    ffmpeg -i input.mp4 -vf scale=960:-1 -movflags faststart -vcodec libx264 -crf 20 -g 1 -pix_fmt yuv420p output.mp4
    --------------------------------
    */
  </style>
</head>

<body>
  <div id="smooth-wrapper">
    <div id="smooth-content">
      <div class="parallax"></div>

      <!-- Video section -->
      <section class="video-section">
        <video class="video" playsinline webkit-playsinline preload="auto" muted>
          <source src="https://www.dropbox.com/scl/fi/v2g4lfx3kv63vojs7ut2f/output3.mp4?rlkey=0bo4q86youw201quxeklg6ys2&st=jxzb3lql&raw=1" type="video/mp4" />
        </video>
      </section>

      <div class="parallax1"></div>
    </div>
  </div>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    const coolVideo = document.querySelector("video");

    let tl = gsap.timeline({
      scrollTrigger: {
        trigger: ".video-section",
        start: "top top",
        end: "bottom+=1800% bottom", // makes scroll longer/slower
        scrub: true,
        markers: false // set to true if you want debug markers
      }
    });

    // Wait for video metadata before animating
    coolVideo.onloadedmetadata = function () {
      tl.to(coolVideo, { currentTime: coolVideo.duration });
    };

    // Touch device fix
    function isTouchDevice() {
      return (
        "ontouchstart" in window ||
        navigator.maxTouchPoints > 0 ||
        navigator.msMaxTouchPoints > 0
      );
    }

    if (isTouchDevice()) {
      coolVideo.play();
      coolVideo.pause();
    }
  </script>
</body>
</html>
